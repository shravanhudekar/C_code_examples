/*
 * circular_buffer.c
 *
 *  Created on: Sep 17, 2022
 *      Author: incads1917
 */


#include"circular_buffer.h"

buffer_t  data_node;

void buffer_init()
{
	data_node.bufferlength=0;
	data_node.head=0;
	data_node.tail=0;
	memset(&data_node.data,0,sizeof(data_node.data));
}

void write_buffer(uint8_t user_data)
{

	if (bufferlength == SIZE_OF_BUFFER)
	{
		HAL_GPIO_WritePin(GPIOB, GPIO_PIN_14, GPIO_PIN_SET);
	}

	else
	{
		data_node.data[bufferlength]=user_data;
		bufferlength++;
		data_node.head++;
		HAL_GPIO_WritePin(GPIOE, GPIO_PIN_1, GPIO_PIN_RESET);
	}

}

void read_buffer()
{
	void read_data;
	if (bufferlength == 0)
	{
		HAL_GPIO_WritePin(GPIOE, GPIO_PIN_1, GPIO_PIN_SET);
	}

	else
	{
		read_data=data_node.data[bufferlength];
		bufferlength--;
		data_node.tail++;
		HAL_GPIO_WritePin(GPIOB, GPIO_PIN_14, GPIO_PIN_RESET);
	}

}
